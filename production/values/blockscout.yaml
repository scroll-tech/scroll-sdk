envFrom:
  - secretRef:
      name: blockscout-env

persistence:
  env:
    enabled: true
    type: secret
    mountPath: /config/
    name: blockscout-env

initContainers:
  2-migrate-db:
    image: blockscout/blockscout:6.6.0
    command: ["/bin/sh", "-c", "/app/bin/blockscout eval \"Elixir.Explorer.ReleaseTasks.create_and_migrate()\""]
    envFrom:
      - secretRef:
          name: blockscout-env
  3-check-postgres-connection:
    image: atkrad/wait4x:latest
    args:
      - postgresql
      - $(DATABASE_URL)
    envFrom:
      - secretRef:
          name: blockscout-env

ingress:
  main:
    ingressClassName: "nginx"
    hosts:
      - host: blockscout-2.devnet.scroll.tech
        paths:
          - path: /
            pathType: Prefix

externalSecrets:
  blockscout-env:
    data:
      - remoteRef:
          key: scroll/blockscout-env
          property: DATABASE_URL
        secretKey: DATABASE_URL
    refreshInterval: 2m
    serviceAccount: external-secrets
